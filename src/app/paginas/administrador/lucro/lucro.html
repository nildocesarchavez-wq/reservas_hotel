<div class="app-container">
  <!-- HEADER TOP -->
  <app-header-admin></app-header-admin>

  <!-- SIDEBAR -->
  <app-sidebar-admin></app-sidebar-admin>

  <!-- MAIN CONTENT -->
  <main class="main-content">
    <div class="content-wrapper">
      <!-- PAGE HEADER -->
      <div class="page-header">
        <h1 class="page-title">Detalles de ganancias</h1>
        <p class="page-subtitle">Análisis de lucro basado en el 10% del total de las transacciones.</p>
      </div>

      <!-- LOADING STATE -->
      <div *ngIf="cargando" class="loading-container">
        <div class="loading-spinner"></div>
        <p>Cargando datos de ganancias...</p>
      </div>

      <!-- ERROR STATE -->
      <div *ngIf="error && !cargando" class="error-container">
        <i class="fa fa-exclamation-triangle"></i>
        <p>{{ error }}</p>
        <button (click)="recargar()" class="btn-reload">
          <i class="fa fa-refresh"></i> Reintentar
        </button>
      </div>

      <!-- EMPTY STATE -->
      <div *ngIf="!cargando && !error && lucroDetalles.length === 0" class="empty-container">
        <i class="fa fa-money fa-3x"></i>
        <p>No hay reservas completadas o confirmadas para mostrar</p>
      </div>

      <!-- CONTENT GRID -->
      <div *ngIf="!cargando && !error && lucroDetalles.length > 0" 
           class="content-grid" 
           style="grid-template-columns: 1fr;">

        <!-- CARD: GRÁFICO DE GANANCIAS -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">GANANCIAS POR FECHA DE SALIDA</h3>
          </div>
          <div class="card-body">
            <!-- Contenedor del gráfico -->
            <div class="chart-container">
              <div id="chart"></div>
            </div>
          </div>
        </div>

        <!-- CARD: TABLA DE DETALLES DE LUCRO -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">DESGLOSE DETALLADO DE LUCRO</h3>
          </div>
          <div class="card-body">
            <div class="table-container">
              <table class="data-table" id="dataTables-example">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Entrada</th>
                    <th>Salida</th>
                    <th>Alquiler Hab. (USD)</th>
                    <th>Extras (USD)</th>
                    <th>Comidas (USD)</th>
                    <th>Gr. Total (USD)</th>
                    <th>Lucro (10%)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let detalle of lucroDetalles; let i = index" 
                      [class.odd]="i % 2 === 0"
                      [class.even]="i % 2 !== 0">
                    <td>{{ detalle.id.substring(0, 8) }}</td>
                    <td>{{ detalle.nombre }}</td>
                    <td>{{ detalle.fechaEntrada }}</td>
                    <td>{{ detalle.fechaSalida }}</td>
                    <td>{{ formatearMoneda(detalle.alquilerHabitacion) }}</td>
                    <td>{{ formatearMoneda(detalle.extras) }}</td>
                    <td>{{ formatearMoneda(detalle.comidas) }}</td>
                    <td><strong>{{ formatearMoneda(detalle.granTotal) }}</strong></td>
                    <td><strong class="text-success">{{ formatearMoneda(detalle.lucro) }}</strong></td>
                  </tr>
                </tbody>
                <tfoot>
                  <tr>
                    <th colspan="7" style="text-align: right;">Total de Ganancias:</th>
                    <th>{{ formatearMoneda(totalGeneral) }}</th>
                    <th><strong class="text-success">{{ formatearMoneda(totalLucro) }}</strong></th>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>
</div>